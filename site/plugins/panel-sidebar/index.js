(function(){"use strict";function c(e,t,i,o,n,a,r,b){var s=typeof e=="function"?e.options:e;return t&&(s.render=t,s.staticRenderFns=i,s._compiled=!0),{exports:e,options:s}}const l={props:{navigation:{type:Array,default:()=>[]},items:{type:Array,default:()=>[]},defaultView:String},watch:{navigation:{immediate:!0,handler(e){if(e&&e.length&&(!this.items||this.items.length===0)){console.log("Processing navigation from props",e);const t=e.map(i=>({name:i.name||`nav-${Date.now()}`,label:i.label||"Untitled",icon:i.icon||"page",view:i.view||null}));this.$set(this,"items",t)}}}},data(){return{currentItem:null,currentView:null,viewComponents:{},$liveRegion:null,tabId:`sidebar-${Date.now()}`}},mounted(){this.$nextTick(()=>{if(this.markControlledSections(),this.items&&this.items.length>0){if(this.defaultView){const t=this.items.find(i=>i.view===this.defaultView);if(t){this.selectItem(t),this.showSection(t.view);return}}const e=this.items.find(t=>t.view!=="heading");e&&(this.selectItem(e),this.showSection(e.view))}})},methods:{selectItem(e){e.view!=="heading"&&(this.currentItem=e,this.announceTabChange(e.label),this.showSection(e.view),e.view?this.viewComponents[e.view]?this.currentView=this.viewComponents[e.view]:this.loadView(e.view):this.currentView=null)},markControlledSections(){this.items.forEach(t=>{if(t.view&&t.view!=="heading"){const i=`.k-section-name-${t.view}`,o=document.querySelector(i);o&&(o.setAttribute("data-sidebar-controlled","true"),console.log(`Marked section ${t.view} as controlled by sidebar`))}}),document.querySelectorAll('[data-sidebar-controlled="true"]').forEach(t=>{t.classList.remove("is-active")})},showSection(e){const t=new CustomEvent("sidebar-tab-changed",{detail:{viewName:e},bubbles:!0});window.dispatchEvent(t),console.log(`Dispatched sidebar-tab-changed event for ${e}`),this.directlyShowSection(e)},directlyShowSection(e){document.querySelectorAll('[data-sidebar-controlled="true"]').forEach(o=>{o.classList.remove("is-active")});const i=document.querySelector(`.k-section-name-${e}`);i&&(i.classList.add("is-active"),console.log(`Directly activated section ${e}`))},async loadView(e){var t,i;try{console.log("Loading view:",e),(i=(t=window.panel)==null?void 0:t.views)!=null&&i[e]?(console.log("Found registered panel view"),this.currentView=e,this.viewComponents[e]=e):this.$root.$options.components[e]?(console.log("Found global component"),this.currentView=e,this.viewComponents[e]=e):(console.log("Using view name directly"),this.currentView=e,this.viewComponents[e]=e)}catch(o){console.error("Error loading view:",o),this.$store.dispatch("notification/error",`Could not load view: ${o.message}`),this.currentView=null}},focusNextTab(){const e=this.getClickableTabs();if(e.length===0)return;const i=(this.getCurrentTabIndex(e)+1)%e.length;e[i].focus()},focusPreviousTab(){const e=this.getClickableTabs();if(e.length===0)return;const i=(this.getCurrentTabIndex(e)-1+e.length)%e.length;e[i].focus()},getClickableTabs(){return Array.from(this.$el.querySelectorAll(".k-sidebar-tab-button"))},getCurrentTabIndex(e){const t=document.activeElement;return e.indexOf(t)},announceTabChange(e){this.$liveRegion||(this.$liveRegion=document.createElement("div"),this.$liveRegion.setAttribute("aria-live","polite"),this.$liveRegion.setAttribute("class","sr-only"),document.body.appendChild(this.$liveRegion)),this.$liveRegion.textContent=`${e} tab selected`,setTimeout(()=>{this.$liveRegion.textContent=""},1e3)}}};var d=function(){var t=this,i=t._self._c;return i("section",{staticClass:"k-sidebar-section",attrs:{role:"tablist","aria-orientation":"vertical"}},[i("div",{staticClass:"k-sidebar-tabs"},[t.items&&t.items.length>0?i("ul",t._l(t.items,function(o){return i("li",{key:o.name,class:{"k-sidebar-heading-item":o.view==="heading","k-sidebar-tab-item":o.view!=="heading"}},[o.view==="heading"?[i("div",{staticClass:"k-sidebar-heading",attrs:{role:"presentation"}},[t._v(" "+t._s(o.label)+" ")])]:i("button",{staticClass:"k-sidebar-tab-button",class:{"is-active":t.currentItem&&t.currentItem.name===o.name},attrs:{id:`tab-${o.name}`,"aria-selected":t.currentItem&&t.currentItem.name===o.name,"aria-controls":`panel-${o.view}`,role:"tab",tabindex:"0"},on:{click:function(n){return t.selectItem(o)},keydown:[function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"space",32,n.key,[" ","Spacebar"])?null:(n.preventDefault(),t.selectItem(o))},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:(n.preventDefault(),t.selectItem(o))},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"right",39,n.key,["Right","ArrowRight"])||"button"in n&&n.button!==2?null:(n.preventDefault(),t.focusNextTab.apply(null,arguments))},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"left",37,n.key,["Left","ArrowLeft"])||"button"in n&&n.button!==0?null:(n.preventDefault(),t.focusPreviousTab.apply(null,arguments))},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"down",40,n.key,["Down","ArrowDown"])?null:(n.preventDefault(),t.focusNextTab.apply(null,arguments))},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"up",38,n.key,["Up","ArrowUp"])?null:(n.preventDefault(),t.focusPreviousTab.apply(null,arguments))}]}},[o.icon?i("span",{staticClass:"k-sidebar-tab-icon"},[i("k-icon",{attrs:{type:o.icon}})],1):t._e(),i("span",{staticClass:"k-sidebar-tab-label"},[t._v(t._s(o.label))])])],2)}),0):i("div",{staticClass:"k-sidebar-loading"},[i("k-text",[t._v("Loading navigation items...")])],1)])])},u=[],f=c(l,d,u);const h=f.exports;window.panel.plugin("2inchesofwater/panel-sidebar",{created(){console.log("Panel sidebar plugin initialized");const e=new MutationObserver(t=>{t.forEach(i=>{i.type==="childList"&&i.addedNodes.length&&this.initializeSections()})});setTimeout(()=>{const t=document.querySelector(".k-collection");t&&(e.observe(t,{childList:!0,subtree:!0}),this.initializeSections())},100)},sections:{sidebar:h},use:{plugin:function(){const e=document.createElement("style");e.textContent=`
        /* Position the sidebar properly */
        .k-section-name-sidebar {
          position: relative;
          z-index: 2;
          width: 220px !important; /* Force fixed width */
          flex: 0 0 220px !important;
          border-right: 1px solid var(--color-border);
          min-height: 100%;
        }
        
        /* Make the content sections appear next to the sidebar */
        [data-sidebar-controlled="true"] {
          display: none !important;
          position: relative;
          z-index: 1;
          margin-left: 220px !important;
          width: calc(100% - 220px) !important;
          flex: 1 1 auto !important;
        }
        
        /* Show only the active section */
        [data-sidebar-controlled="true"].is-active {
          display: block !important;
        }
        
        /* Make the .k-collection container flex */
        .k-collection {
          display: flex !important;
          position: relative;
        }
      `,document.head.appendChild(e),window.addEventListener("sidebar-tab-changed",function(t){if(t.detail&&t.detail.viewName){const i=t.detail.viewName;document.querySelectorAll('[data-sidebar-controlled="true"]').forEach(a=>{a.classList.remove("is-active")});const n=document.querySelector(`.k-section-name-${i}`);if(n)n.classList.add("is-active"),console.log(`Activated section: ${i}`);else{console.log(`Section ${i} not found yet, will retry`);const a=new MutationObserver(function(b){const s=document.querySelector(`.k-section-name-${i}`);s&&(s.setAttribute("data-sidebar-controlled","true"),s.classList.add("is-active"),console.log(`Found and activated section: ${i}`),a.disconnect())}),r=document.querySelector(".k-collection");r&&(a.observe(r,{childList:!0,subtree:!0}),setTimeout(()=>a.disconnect(),5e3))}}})}},views:{"sidebar-content":{component:{props:{content:String},template:`
          <div class="k-sidebar-content-view">
            <k-text>{{ content || 'Content view' }}</k-text>
          </div>
        `}},"sidebar-message":{component:{props:{message:{type:String,default:"No content to display"},icon:{type:String,default:"info"}},template:`
          <div class="k-sidebar-message-view">
            <k-icon :type="icon" size="large" class="k-sidebar-message-icon" />
            <k-text align="center">{{ message }}</k-text>
          </div>
        `}}},methods:{getPanelId(e){return`panel-${e}`},hasView(e){var t,i;return!!((i=(t=window.panel)==null?void 0:t.views)!=null&&i[e])},initializeSections(){console.log("Initializing sections for sidebar");const e=document.querySelectorAll('[data-sidebar-controlled="true"]'),t=Array.from(e).some(i=>i.classList.contains("is-active"));if(e.length&&!t){console.log("No active section found, activating default");const i=document.querySelector(".k-section-name-sidebar");if(i){const o=i.__vue__;if(o&&o.defaultView){const n=document.querySelector(`.k-section-name-${o.defaultView}`);n&&(n.classList.add("is-active"),console.log(`Activated default section: ${o.defaultView}`))}else e[0]&&(e[0].classList.add("is-active"),console.log("Activated first section"))}}}}})})();
